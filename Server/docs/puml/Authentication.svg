<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="550px" preserveAspectRatio="none" style="width:534px;height:550px;" version="1.1" viewBox="0 0 534 550" width="534px" zoomAndPan="magnify"><defs><filter height="300%" id="fnumt6ptus87o" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="113" x="208.75" y="30.6855">Authentication</text><rect fill="#FFFFFF" filter="url(#fnumt6ptus87o)" height="79.0547" style="stroke:#000000;stroke-width:2.0;" width="510.5" x="10" y="199.3047"/><rect fill="#FFFFFF" filter="url(#fnumt6ptus87o)" height="92.0547" style="stroke:#000000;stroke-width:2.0;" width="295" x="225.5" y="396.4141"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="50" x2="50" y1="78.25" y2="505.4688"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="262.5" x2="262.5" y1="78.25" y2="505.4688"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="424.5" x2="424.5" y1="78.25" y2="505.4688"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="481.5" x2="481.5" y1="78.25" y2="505.4688"/><rect fill="#FEFECE" filter="url(#fnumt6ptus87o)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="56" x="20" y="41.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="27" y="63.1738">Server</text><rect fill="#FEFECE" filter="url(#fnumt6ptus87o)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="56" x="20" y="504.4688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="27" y="526.002">Server</text><rect fill="#FEFECE" filter="url(#fnumt6ptus87o)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="51" x="235.5" y="41.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="242.5" y="63.1738">Agent</text><rect fill="#FEFECE" filter="url(#fnumt6ptus87o)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="51" x="235.5" y="504.4688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="242.5" y="526.002">Agent</text><rect fill="#FEFECE" filter="url(#fnumt6ptus87o)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="33" x="406.5" y="41.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19" x="413.5" y="63.1738">DB</text><rect fill="#FEFECE" filter="url(#fnumt6ptus87o)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="33" x="406.5" y="504.4688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19" x="413.5" y="526.002">DB</text><rect fill="#FEFECE" filter="url(#fnumt6ptus87o)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="53" x="453.5" y="41.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="460.5" y="63.1738">OCSP</text><rect fill="#FEFECE" filter="url(#fnumt6ptus87o)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="53" x="453.5" y="504.4688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="460.5" y="526.002">OCSP</text><polygon fill="#A80036" points="61,106.6016,51,110.6016,61,114.6016,57,110.6016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="55" x2="262" y1="110.6016" y2="110.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="67" y="105.7451">Authenticate, present Agent TLS</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="50" x2="92" y1="140.9531" y2="140.9531"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="92" x2="92" y1="140.9531" y2="153.9531"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="51" x2="92" y1="153.9531" y2="153.9531"/><polygon fill="#A80036" points="61,149.9531,51,153.9531,61,157.9531,57,153.9531" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="57" y="136.0967">Validate client TLS</text><polygon fill="#A80036" points="470,180.3047,480,184.3047,470,188.3047,474,184.3047" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="50" x2="476" y1="184.3047" y2="184.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="57" y="179.4482">Check for blocked certs</text><path d="M10,199.3047 L75,199.3047 L75,207.3047 L65,217.3047 L10,217.3047 L10,199.3047 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="79.0547" style="stroke:#000000;stroke-width:2.0;" width="510.5" x="10" y="199.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20" x="25" y="213.7998">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="136" x="90" y="212.7236">[if Agent cert is blocked]</text><polygon fill="#A80036" points="61,236.0078,51,240.0078,61,244.0078,57,240.0078" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="55" x2="481" y1="240.0078" y2="240.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="67" y="235.1514">Invalid</text><polygon fill="#A80036" points="251,266.3594,261,270.3594,251,274.3594,255,270.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="50" x2="257" y1="270.3594" y2="270.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="57" y="265.5029">Invalid cert response</text><polygon fill="#A80036" points="251,303.7109,261,307.7109,251,311.7109,255,307.7109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="50" x2="257" y1="307.7109" y2="307.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="57" y="302.8545">Preset Server TLS</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="263" x2="305" y1="338.0625" y2="338.0625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="305" x2="305" y1="338.0625" y2="351.0625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="264" x2="305" y1="351.0625" y2="351.0625"/><polygon fill="#A80036" points="274,347.0625,264,351.0625,274,355.0625,270,351.0625" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="270" y="333.2061">Validate server TLS</text><polygon fill="#A80036" points="470,377.4141,480,381.4141,470,385.4141,474,381.4141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="263" x2="476" y1="381.4141" y2="381.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="270" y="376.5576">Check for blocked certs of server</text><path d="M225.5,396.4141 L290.5,396.4141 L290.5,404.4141 L280.5,414.4141 L225.5,414.4141 L225.5,396.4141 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="92.0547" style="stroke:#000000;stroke-width:2.0;" width="295" x="225.5" y="396.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20" x="240.5" y="410.9092">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140" x="305.5" y="409.833">[if Server cert is blocked]</text><polygon fill="#A80036" points="274,433.1172,264,437.1172,274,441.1172,270,437.1172" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="268" x2="481" y1="437.1172" y2="437.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="280" y="432.2607">Invalid</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="263" x2="305" y1="467.4688" y2="467.4688"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="305" x2="305" y1="467.4688" y2="480.4688"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="264" x2="305" y1="480.4688" y2="480.4688"/><polygon fill="#A80036" points="274,476.4688,264,480.4688,274,484.4688,270,480.4688" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="270" y="462.6123">Log invalid server and exit</text><!--MD5=[8636ba0f46e5db2135aec4dcefa01f0c]
@startuml
title Authentication

participant Server
participant Agent
participant DB

Agent -> Server: Authenticate, present Agent TLS
Server - -> Server: Validate client TLS
Server - -> OCSP: Check for blocked certs
opt if Agent cert is blocked
    OCSP - -> Server: Invalid
    Server - -> Agent: Invalid cert response
end

Server - -> Agent: Preset Server TLS
Agent - -> Agent: Validate server TLS
Agent -> OCSP: Check for blocked certs of server
opt if Server cert is blocked
    OCSP - -> Agent: Invalid
    Agent - -> Agent: Log invalid server and exit
end
@enduml

PlantUML version 1.2021.00(Sun Jan 10 15:55:05 IST 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>